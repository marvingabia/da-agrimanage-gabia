<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Municipal Agriculture Office - Bulalacao, Oriental Mindoro</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Google OAuth disabled - configure in GOOGLE_OAUTH_SETUP.md to enable -->
    <!-- <script src="https://accounts.google.com/gsi/client" async defer></script> -->
    <!-- <meta name="google-signin-client_id" content="YOUR_GOOGLE_CLIENT_ID"> -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            height: 100vh;
            background: linear-gradient(135deg, #2d5016 0%, #4a7c59 50%, #1a4731 100%);
            background-attachment: fixed;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0;
            padding: 0;
            position: relative;
            overflow-x: hidden;
            overflow-y: auto;
        }
        
        .background-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="rice" width="20" height="20" patternUnits="userSpaceOnUse"><path d="M10,2 Q12,8 10,14 Q8,8 10,2" fill="rgba(255,255,255,0.05)"/><path d="M5,10 Q7,16 5,22 Q3,16 5,10" fill="rgba(255,255,255,0.03)"/><path d="M15,6 Q17,12 15,18 Q13,12 15,6" fill="rgba(255,255,255,0.04)"/></pattern></defs><rect width="100" height="100" fill="url(%23rice)"/></svg>'),
                radial-gradient(circle at 20% 80%, rgba(255,255,255,0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255,255,255,0.1) 0%, transparent 50%);
            opacity: 0.6;
        }
        
        .municipality-logo {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            height: 80%;
            opacity: 0.08;
            z-index: 1;
            background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><circle cx="100" cy="100" r="95" fill="none" stroke="rgba(255,255,255,0.3)" stroke-width="2"/><circle cx="100" cy="100" r="75" fill="none" stroke="rgba(255,255,255,0.2)" stroke-width="1"/><text x="100" y="60" text-anchor="middle" fill="rgba(255,255,255,0.4)" font-size="12" font-weight="bold">MUNICIPALITY OF</text><text x="100" y="80" text-anchor="middle" fill="rgba(255,255,255,0.4)" font-size="16" font-weight="bold">BULALACAO</text><text x="100" y="130" text-anchor="middle" fill="rgba(255,255,255,0.3)" font-size="10">PROVINCE OF</text><text x="100" y="145" text-anchor="middle" fill="rgba(255,255,255,0.3)" font-size="12">ORIENTAL MINDORO</text></svg>');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }
        
        .login-container {
            position: relative;
            z-index: 10;
            width: 100%;
            max-width: 450px;
            padding: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .login-card {
            background: rgba(255, 255, 255, 0.12);
            backdrop-filter: blur(25px);
            border-radius: 25px;
            padding: 2rem;
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.3),
                0 0 0 1px rgba(255, 255, 255, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.15);
            text-align: center;
            position: relative;
            z-index: 10;
            width: 100%;
            max-width: 420px;
            margin: auto;
            max-height: 95vh;
            overflow-y: auto;
        }
        
        .login-header {
            margin-bottom: 1.5rem;
        }
        
        .municipality-logo-small {
            width: 60px;
            height: 60px;
            margin: 0 auto 0.75rem auto;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
            border: 3px solid rgba(255, 255, 255, 0.3);
        }
        
        .municipality-logo-small svg {
            width: 45px;
            height: 45px;
        }
        
        .login-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
            margin-bottom: 0.25rem;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
            line-height: 1.2;
        }
        
        .login-subtitle {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.85rem;
            font-weight: 500;
            margin-bottom: 0.25rem;
            text-shadow: 0 1px 5px rgba(0, 0, 0, 0.3);
        }
        
        .login-department {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.8rem;
            font-weight: 400;
            margin-bottom: 0;
            text-shadow: 0 1px 5px rgba(0, 0, 0, 0.3);
        }
        
        .form-group {
            margin-bottom: 1.25rem;
            text-align: left;
        }
        
        .form-label {
            color: white;
            font-weight: 500;
            margin-bottom: 0.5rem;
            display: block;
            font-size: 0.95rem;
        }
        
        .password-input-container {
            position: relative;
        }
        
        .form-control {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 0.875rem 1.25rem;
            color: white;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            width: 100%;
        }
        
        .password-toggle {
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            padding: 0.25rem;
            transition: color 0.3s ease;
        }
        
        .password-toggle:hover {
            color: white;
        }
        
        .form-control::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        
        .form-control:focus {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.4);
            box-shadow: 0 0 0 0.2rem rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .forgot-password {
            text-align: right;
            margin-top: 0.5rem;
        }
        
        .forgot-password a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.3s ease;
        }
        
        .forgot-password a:hover {
            color: white;
        }
        
        .login-btn {
            width: 100%;
            background: linear-gradient(135deg, #4a7c59 0%, #2d5016 100%);
            border: none;
            border-radius: 25px;
            padding: 0.875rem;
            color: white;
            font-size: 1rem;
            font-weight: 600;
            margin: 1.5rem 0 1rem 0;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(45, 80, 22, 0.4);
        }
        
        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(45, 80, 22, 0.5);
            background: linear-gradient(135deg, #2d5016 0%, #1a4731 100%);
        }
        
        .login-btn:active {
            transform: translateY(0);
        }
        
        .divider {
            margin: 1rem 0;
            position: relative;
            text-align: center;
        }
        
        .divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: rgba(255, 255, 255, 0.2);
        }
        
        .divider span {
            background: rgba(255, 255, 255, 0.15);
            color: rgba(255, 255, 255, 0.8);
            padding: 0 1rem;
            font-size: 0.9rem;
            backdrop-filter: blur(10px);
        }
        
        .google-btn {
            width: 100%;
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            padding: 0.875rem;
            color: #1f2937;
            font-size: 0.95rem;
            font-weight: 500;
            margin-bottom: 1.25rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .google-btn:hover {
            background: rgba(255, 255, 255, 1);
            transform: translateY(-1px);
            color: #1f2937;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        }
        
        .google-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .g_id_signin {
            margin-bottom: 1.25rem;
        }
        
        .google-signin-container {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .register-link {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.95rem;
        }
        
        .register-link a {
            color: #4285f4;
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s ease;
        }
        
        .register-link a:hover {
            color: #1a73e8;
        }
        
        .alert {
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            backdrop-filter: blur(10px);
            color: white;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .alert.error {
            background: rgba(220, 53, 69, 0.2);
            border: 1px solid rgba(220, 53, 69, 0.3);
        }
        
        .alert.success {
            background: rgba(16, 185, 129, 0.2);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }
        
        .role-selector {
            margin-bottom: 1.5rem;
        }
        
        .role-tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 0.25rem;
            margin-bottom: 0.75rem;
        }
        
        .role-tab {
            flex: 1;
            padding: 0.625rem;
            text-align: center;
            border-radius: 8px;
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 0.85rem;
        }
        
        .role-tab.active {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            backdrop-filter: blur(10px);
        }
        
        .role-tab:hover {
            color: white;
        }
        
        /* Registration Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }
        
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .modal-title {
            color: white;
            font-size: 1.5rem;
            font-weight: 600;
            margin: 0;
        }
        
        .close-btn {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.25rem;
            transition: color 0.3s ease;
        }
        
        .close-btn:hover {
            color: white;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 0;
                overflow-y: auto;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .login-container {
                padding: 1rem;
                min-height: 100vh;
                display: flex;
                align-items: center;
                justify-content: center;
                margin: 0 auto;
            }
            
            .login-card {
                padding: 1.5rem 1.25rem;
                max-height: none;
                min-height: auto;
                border-radius: 20px;
                margin: auto;
                width: 100%;
                max-width: 95%;
            }
            
            .login-title {
                font-size: 1.35rem;
            }
            
            .login-subtitle {
                font-size: 0.8rem;
            }
            
            .login-department {
                font-size: 0.75rem;
            }
            
            .role-tabs {
                flex-direction: column;
                gap: 0.25rem;
            }
            
            .role-tab {
                padding: 0.75rem;
                font-size: 0.9rem;
            }
            
            .modal-content {
                padding: 1.5rem;
                margin: 1rem;
            }
        }
        
        @media (max-width: 480px) {
            body {
                padding: 0;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .login-container {
                padding: 0.75rem;
                min-height: 100vh;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .login-card {
                padding: 1.25rem 1rem;
                border-radius: 15px;
                margin: auto;
                width: 100%;
                max-width: 95%;
                min-height: auto;
            }
            
            .login-title {
                font-size: 1.25rem;
            }
            
            .login-subtitle {
                font-size: 0.75rem;
            }
            
            .login-department {
                font-size: 0.7rem;
            }
            
            .municipality-logo-small {
                width: 50px;
                height: 50px;
                margin-bottom: 0.5rem;
            }
            
            .municipality-logo-small svg {
                width: 35px;
                height: 35px;
            }
            
            .form-control {
                padding: 0.75rem 1rem;
                font-size: 0.9rem;
            }
            
            .login-btn, .google-btn {
                padding: 0.75rem;
                font-size: 0.95rem;
                width: 100%;
            }
            
            .form-group {
                margin-bottom: 1rem;
            }
            
            .login-btn {
                margin: 1.25rem 0 0.75rem 0;
            }
            
            .google-btn {
                margin-bottom: 1rem;
            }
            
            .divider {
                margin: 0.75rem 0;
            }
            
            .form-control {
                font-size: 16px; /* Prevents zoom on iOS */
            }
            
            .login-title {
                font-size: 1.25rem;
                line-height: 1.3;
            }
            
            .login-subtitle, .login-department {
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="background-overlay"></div>
    <div class="municipality-logo"></div>
    
    <div class="login-container">
        <div class="login-card">
            <div class="login-header">
                <div class="municipality-logo-small">
                    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <!-- Municipality Logo SVG -->
                        <circle cx="50" cy="50" r="45" fill="#2d5016" stroke="#4a7c59" stroke-width="2"/>
                        <circle cx="50" cy="50" r="35" fill="#4a7c59"/>
                        <rect x="35" y="35" width="30" height="30" fill="#2d5016" rx="3"/>
                        <rect x="40" y="40" width="20" height="20" fill="#6b9b47" rx="2"/>
                        <!-- Rice/Agriculture symbol -->
                        <path d="M45,25 Q50,35 45,45 Q40,35 45,25" fill="#ffd700"/>
                        <path d="M55,25 Q60,35 55,45 Q50,35 55,25" fill="#ffd700"/>
                        <path d="M50,20 Q55,30 50,40 Q45,30 50,20" fill="#ffed4e"/>
                        <!-- Anchor symbol -->
                        <circle cx="50" cy="55" r="3" fill="#1a4731"/>
                        <path d="M50,52 L50,68 M45,65 Q50,70 55,65" stroke="#1a4731" stroke-width="2" fill="none"/>
                    </svg>
                </div>
                <h1 class="login-title">Municipal Agriculture Office</h1>
                <p class="login-subtitle">Municipality of Bulalacao</p>
                <p class="login-department">Oriental Mindoro</p>
            </div>
            
            {{#if error}}
            <div class="alert error">
                <i class="fas fa-exclamation-triangle me-2"></i>
                {{error}}
            </div>
            {{/if}}
            
            {{#if success}}
            <div class="alert success">
                <i class="fas fa-check-circle me-2"></i>
                {{success}}
            </div>
            {{/if}}
            
            <form action="/login" method="POST" id="loginForm">
                <div class="role-selector">
                    <div class="role-tabs">
                        <div class="role-tab active" data-role="admin">
                            <i class="fas fa-user-shield me-1"></i>
                            Admin
                        </div>
                        <div class="role-tab" data-role="staff">
                            <i class="fas fa-user-tie me-1"></i>
                            Staff
                        </div>
                        <div class="role-tab" data-role="farmer">
                            <i class="fas fa-user me-1"></i>
                            Farmer
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="email" class="form-label">Email</label>
                    <input 
                        type="email" 
                        class="form-control" 
                        id="email" 
                        name="email" 
                        placeholder="e.g., admin@ibarangay.com"
                        required
                    >
                </div>
                
                <div class="form-group">
                    <label for="password" class="form-label">Password</label>
                    <div class="password-input-container">
                        <input 
                            type="password" 
                            class="form-control" 
                            id="password" 
                            name="password" 
                            placeholder="Enter your password"
                            required
                        >
                        <button type="button" class="password-toggle" onclick="togglePassword()">
                            <i class="fas fa-eye" id="passwordIcon"></i>
                        </button>
                    </div>
                    <div class="forgot-password">
                        <a href="/forgot-password">Forgot password?</a>
                    </div>
                </div>
                
                <input type="hidden" name="role" id="selectedRole" value="admin">
                
                <button type="submit" class="btn login-btn">
                    <i class="fas fa-sign-in-alt me-2"></i>
                    Login
                </button>
            </form>
            
            <div class="divider">
                <span>OR CONTINUE WITH</span>
            </div>
            
            <!-- Google OAuth Disabled - Use email/password login -->
            <!-- To enable: Configure Google OAuth in GOOGLE_OAUTH_SETUP.md -->
            <div class="google-signin-container" style="display: none;">
                <button class="btn google-btn" onclick="alert('Google OAuth not configured. Please use email/password login.')" id="customGoogleBtn">
                    <i class="fab fa-google" style="color: #4285f4;"></i>
                    Continue with Google
                </button>
            </div>
            
            <div class="register-link">
                Don't have an account? <a href="#" onclick="openRegisterModal('farmer')">Register as Farmer</a>
            </div>
        </div>
    </div>
    
    <!-- Farmer Registration Modal -->
    <div id="farmerModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Farmer Registration</h3>
                <button class="close-btn" onclick="closeModal('farmerModal')">&times;</button>
            </div>
            <form id="farmerRegisterForm" action="/register" method="POST">
                <input type="hidden" name="role" value="farmer">
                <div class="form-group">
                    <label class="form-label">Full Name</label>
                    <input type="text" class="form-control" name="name" placeholder="Enter your full name" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Email Address</label>
                    <input type="email" class="form-control" name="email" placeholder="Enter your email" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Phone Number</label>
                    <input type="tel" class="form-control" name="phone" placeholder="Enter your phone number" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Barangay</label>
                    <select class="form-control" name="barangay" required style="color: #1e293b;">
                        <option value="" style="color: #6b7280;">Select Barangay</option>
                        <option value="Bagong Sikat" style="background: white; color: #1e293b;">Bagong Sikat</option>
                        <option value="Balatasan" style="background: white; color: #1e293b;">Balatasan</option>
                        <option value="Benli" style="background: white; color: #1e293b;">Benli</option>
                        <option value="Cabugao" style="background: white; color: #1e293b;">Cabugao</option>
                        <option value="Cambunang" style="background: white; color: #1e293b;">Cambunang</option>
                        <option value="Campaasan" style="background: white; color: #1e293b;">Campaasan</option>
                        <option value="Maasin" style="background: white; color: #1e293b;">Maasin</option>
                        <option value="Maujao" style="background: white; color: #1e293b;">Maujao</option>
                        <option value="Milagrosa" style="background: white; color: #1e293b;">Milagrosa</option>
                        <option value="Nasukob" style="background: white; color: #1e293b;">Nasukob</option>
                        <option value="Poblacion" style="background: white; color: #1e293b;">Poblacion</option>
                        <option value="San Francisco" style="background: white; color: #1e293b;">San Francisco</option>
                        <option value="San Isidro" style="background: white; color: #1e293b;">San Isidro</option>
                        <option value="San Juan" style="background: white; color: #1e293b;">San Juan</option>
                        <option value="San Roque" style="background: white; color: #1e293b;">San Roque</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-control" id="farmerPassword" name="password" placeholder="Create a password" required minlength="6">
                </div>
                <div class="form-group">
                    <label class="form-label">Confirm Password</label>
                    <input type="password" class="form-control" id="farmerConfirmPassword" placeholder="Re-enter your password" required minlength="6">
                    <small id="farmerPasswordError" class="text-danger" style="display: none; margin-top: 0.5rem;">
                        <i class="fas fa-exclamation-circle me-1"></i>Passwords do not match!
                    </small>
                </div>
                <div class="form-group">
                    <label class="form-label">Land Area (hectares)</label>
                    <input type="number" class="form-control" name="landArea" placeholder="e.g., 2.5" step="0.1" min="0" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Land Type</label>
                    <select class="form-control" name="landType" required>
                        <option value="">Select Land Type</option>
                        <option value="Rice Field">Rice Field</option>
                        <option value="Corn Field">Corn Field</option>
                        <option value="Vegetable Farm">Vegetable Farm</option>
                        <option value="Fruit Orchard">Fruit Orchard</option>
                        <option value="Mixed Farming">Mixed Farming</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <button type="submit" class="btn login-btn">
                    <i class="fas fa-user-plus me-2"></i>Register as Farmer
                </button>
            </form>
        </div>
    </div>
    
    <!-- Staff Registration Modal -->
    <div id="staffModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Staff Registration</h3>
                <button class="close-btn" onclick="closeModal('staffModal')">&times;</button>
            </div>
            <form id="staffRegisterForm" action="/register" method="POST">
                <input type="hidden" name="role" value="staff">
                <div class="form-group">
                    <label class="form-label">Full Name</label>
                    <input type="text" class="form-control" name="name" placeholder="Enter your full name" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Email Address</label>
                    <input type="email" class="form-control" name="email" placeholder="Enter your email" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Phone Number</label>
                    <input type="tel" class="form-control" name="phone" placeholder="Enter your phone number" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Barangay</label>
                    <select class="form-control" name="barangay" required style="color: #1e293b;">
                        <option value="" style="color: #6b7280;">Select Barangay</option>
                        <option value="Bagong Sikat" style="background: white; color: #1e293b;">Bagong Sikat</option>
                        <option value="Balatasan" style="background: white; color: #1e293b;">Balatasan</option>
                        <option value="Benli" style="background: white; color: #1e293b;">Benli</option>
                        <option value="Cabugao" style="background: white; color: #1e293b;">Cabugao</option>
                        <option value="Cambunang" style="background: white; color: #1e293b;">Cambunang</option>
                        <option value="Campaasan" style="background: white; color: #1e293b;">Campaasan</option>
                        <option value="Maasin" style="background: white; color: #1e293b;">Maasin</option>
                        <option value="Maujao" style="background: white; color: #1e293b;">Maujao</option>
                        <option value="Milagrosa" style="background: white; color: #1e293b;">Milagrosa</option>
                        <option value="Nasukob" style="background: white; color: #1e293b;">Nasukob</option>
                        <option value="Poblacion" style="background: white; color: #1e293b;">Poblacion</option>
                        <option value="San Francisco" style="background: white; color: #1e293b;">San Francisco</option>
                        <option value="San Isidro" style="background: white; color: #1e293b;">San Isidro</option>
                        <option value="San Juan" style="background: white; color: #1e293b;">San Juan</option>
                        <option value="San Roque" style="background: white; color: #1e293b;">San Roque</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-control" id="staffPassword" name="password" placeholder="Create a password" required minlength="6">
                </div>
                <div class="form-group">
                    <label class="form-label">Confirm Password</label>
                    <input type="password" class="form-control" id="staffConfirmPassword" placeholder="Re-enter your password" required minlength="6">
                    <small id="staffPasswordError" class="text-danger" style="display: none; margin-top: 0.5rem;">
                        <i class="fas fa-exclamation-circle me-1"></i>Passwords do not match!
                    </small>
                </div>
                <div class="form-group">
                    <label class="form-label">Staffing Management</label>
                    <select class="form-control" name="staffingManagement" required style="color: #1e293b;">
                        <option value="" style="color: #6b7280;">Select Staffing Management</option>
                        <option value="Workforce Planning" style="background: white; color: #1e293b;">Workforce Planning</option>
                        <option value="Recruitment" style="background: white; color: #1e293b;">Recruitment</option>
                        <option value="Selection" style="background: white; color: #1e293b;">Selection</option>
                        <option value="Onboarding" style="background: white; color: #1e293b;">Onboarding</option>
                        <option value="Succession Planning" style="background: white; color: #1e293b;">Succession Planning</option>
                        <option value="Retention" style="background: white; color: #1e293b;">Retention</option>
                        <option value="Performance Management" style="background: white; color: #1e293b;">Performance Management</option>
                    </select>
                </div>
                <button type="submit" class="btn login-btn">
                    <i class="fas fa-user-tie me-2"></i>Register as Staff
                </button>
            </form>
        </div>
    </div>
    </div>
    <!-- End of login-container -->
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Role tab functionality
        document.querySelectorAll('.role-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                // Remove active class from all tabs
                document.querySelectorAll('.role-tab').forEach(t => t.classList.remove('active'));
                
                // Add active class to clicked tab
                this.classList.add('active');
                
                // Update hidden input
                document.getElementById('selectedRole').value = this.dataset.role;
                
                // Update placeholder and prefill admin credentials
                const emailInput = document.getElementById('email');
                const passwordInput = document.getElementById('password');
                const role = this.dataset.role;
                
                // Clear previous values
                emailInput.value = '';
                passwordInput.value = '';
                
                switch(role) {
                    case 'admin':
                        emailInput.placeholder = 'admin@gmail.com';
                        emailInput.value = 'admin@gmail.com';
                        passwordInput.value = 'Admin2025';
                        break;
                    case 'staff':
                        emailInput.placeholder = 'e.g., staff@gmail.com';
                        break;
                    case 'farmer':
                        emailInput.placeholder = 'e.g., farmer@gmail.com';
                        break;
                }
                
                // Show registration option for staff and farmer
                if (role === 'staff') {
                    setTimeout(() => openRegisterModal('staff'), 300);
                } else if (role === 'farmer') {
                    setTimeout(() => openRegisterModal('farmer'), 300);
                }
            });
        });
        
        // Form submission with loading state
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            const submitBtn = this.querySelector('.login-btn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Signing in...';
            submitBtn.disabled = true;
            
            // Show loading message
            const loadingMsg = document.createElement('div');
            loadingMsg.className = 'text-center mt-2';
            loadingMsg.style.color = 'rgba(255, 255, 255, 0.8)';
            loadingMsg.style.fontSize = '0.9rem';
            loadingMsg.innerHTML = 'Redirecting to dashboard...';
            submitBtn.parentNode.appendChild(loadingMsg);
            
            // Re-enable button after 5 seconds in case of error
            setTimeout(() => {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
                if (loadingMsg.parentNode) {
                    loadingMsg.parentNode.removeChild(loadingMsg);
                }
            }, 5000);
        });
        
        // Password toggle functionality
        function togglePassword() {
            const passwordInput = document.getElementById('password');
            const passwordIcon = document.getElementById('passwordIcon');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                passwordIcon.classList.remove('fa-eye');
                passwordIcon.classList.add('fa-eye-slash');
            } else {
                passwordInput.type = 'password';
                passwordIcon.classList.remove('fa-eye-slash');
                passwordIcon.classList.add('fa-eye');
            }
        }
        
        // Modal functionality
        function openRegisterModal(type) {
            const modal = document.getElementById(type + 'Modal');
            modal.classList.add('show');
            document.body.style.overflow = 'hidden';
        }
        
        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.remove('show');
            document.body.style.overflow = 'auto';
        }
        
        // Close modal when clicking outside
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal')) {
                closeModal(e.target.id);
            }
        });
        
        // Farmer password validation
        const farmerPassword = document.getElementById('farmerPassword');
        const farmerConfirmPassword = document.getElementById('farmerConfirmPassword');
        const farmerPasswordError = document.getElementById('farmerPasswordError');
        
        if (farmerConfirmPassword) {
            farmerConfirmPassword.addEventListener('input', function() {
                if (farmerConfirmPassword.value && farmerPassword.value !== farmerConfirmPassword.value) {
                    farmerPasswordError.style.display = 'block';
                    farmerConfirmPassword.style.borderColor = '#dc3545';
                } else {
                    farmerPasswordError.style.display = 'none';
                    farmerConfirmPassword.style.borderColor = '';
                }
            });
        }
        
        // Handle registration form submissions
        document.getElementById('farmerRegisterForm').addEventListener('submit', function(e) {
            const submitBtn = this.querySelector('button[type="submit"]');
            
            // Validate password match
            if (farmerPassword && farmerConfirmPassword && farmerPassword.value !== farmerConfirmPassword.value) {
                e.preventDefault();
                
                alert('Password Mismatch!\n\nYour passwords do not match. Please make sure both password fields are the same.');
                
                farmerConfirmPassword.focus();
                return;
            }
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Creating Account...';
            submitBtn.disabled = true;
            
            // Show loading message
            const loadingMsg = document.createElement('div');
            loadingMsg.className = 'text-center mt-2';
            loadingMsg.style.color = 'rgba(255, 255, 255, 0.8)';
            loadingMsg.style.fontSize = '0.9rem';
            loadingMsg.innerHTML = 'Creating your farmer account. You will need to login after registration...';
            submitBtn.parentNode.appendChild(loadingMsg);
        });
        
        // Staff password validation
        const staffPassword = document.getElementById('staffPassword');
        const staffConfirmPassword = document.getElementById('staffConfirmPassword');
        const staffPasswordError = document.getElementById('staffPasswordError');
        
        if (staffConfirmPassword) {
            staffConfirmPassword.addEventListener('input', function() {
                if (staffConfirmPassword.value && staffPassword.value !== staffConfirmPassword.value) {
                    staffPasswordError.style.display = 'block';
                    staffConfirmPassword.style.borderColor = '#dc3545';
                } else {
                    staffPasswordError.style.display = 'none';
                    staffConfirmPassword.style.borderColor = '';
                }
            });
        }
        
        document.getElementById('staffRegisterForm').addEventListener('submit', function(e) {
            const submitBtn = this.querySelector('button[type="submit"]');
            
            // Validate password match
            if (staffPassword && staffConfirmPassword && staffPassword.value !== staffConfirmPassword.value) {
                e.preventDefault();
                
                alert('Password Mismatch!\n\nYour passwords do not match. Please make sure both password fields are the same.');
                
                staffConfirmPassword.focus();
                return;
            }
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Creating Account...';
            submitBtn.disabled = true;
            
            // Show loading message
            const loadingMsg = document.createElement('div');
            loadingMsg.className = 'text-center mt-2';
            loadingMsg.style.color = 'rgba(255, 255, 255, 0.8)';
            loadingMsg.style.fontSize = '0.9rem';
            loadingMsg.innerHTML = 'Creating your staff account. You will need to login after registration...';
            submitBtn.parentNode.appendChild(loadingMsg);
        });
        
        // Google OAuth Configuration
        let googleInitialized = false;
        
        // Initialize Google Sign-In when page loads
        window.onload = function() {
            // For demo purposes, we'll use the custom button
            // In production, replace the client_id with your actual Google Client ID
            console.log('Initializing Google Sign-In demo mode');
            
            // Hide the official Google button and show custom demo button
            const officialBtn = document.querySelector('.g_id_signin');
            const customBtn = document.getElementById('customGoogleBtn');
            
            if (officialBtn) {
                officialBtn.style.display = 'none';
            }
            
            if (customBtn) {
                customBtn.style.display = 'flex';
                customBtn.innerHTML = '<i class="fab fa-google" style="color: #4285f4;"></i> Continue with Google';
            }
        };
        
        // Handle Google Sign-In response
        function handleCredentialResponse(response) {
            console.log("Encoded JWT ID token: " + response.credential);
            
            // Show loading state
            showGoogleLoading();
            
            // Send the token to your server for verification
            fetch('/auth/google', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    credential: response.credential,
                    role: 'farmer' // Default to farmer for Google sign-in
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Show success message
                    showSuccessMessage('Google sign-in successful! Redirecting to dashboard...');
                    
                    // Redirect to dashboard after short delay
                    setTimeout(() => {
                        window.location.href = '/dashboard';
                    }, 1500);
                } else {
                    hideGoogleLoading();
                    showErrorMessage(data.message || 'Google sign-in failed. Please try again.');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                hideGoogleLoading();
                showErrorMessage('Network error. Please check your connection and try again.');
            });
        }
        
        // Simulate Google Sign-In with account picker
        function simulateGoogleSignIn() {
            showGoogleAccountPicker();
        }
        
        // Show Google Account Picker Modal
        function showGoogleAccountPicker() {
            const modal = document.createElement('div');
            modal.className = 'google-picker-modal';
            modal.innerHTML = `
                <div class="google-picker-overlay"></div>
                <div class="google-picker-content">
                    <div class="google-picker-header">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNzQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCA3NCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik05LjI0IDhWMTJoNS4yOGMtLjI2IDEuMzctMS4wNCAyLjUzLTIuMjEgMy4zMXY0LjlIMTUuNGMxLjk1LTEuNzggMy4wOC00LjQgMy4wOC03LjUgMC0uNzItLjA2LTEuNDItLjE4LTIuMDlIOXoiIGZpbGw9IiM0Mjg1RjQiLz48cGF0aCBkPSJNOSAyMGMzIDAgNS41LTEgNy4zLTIuN2wtMy4xLTIuNGMtLjktLjYtMi0uOS0zLjItLjktMS4zIDAtMi41LjUtMy40IDEuM0w0IDEzLjdDNS43IDEwLjIgOC4yIDggMTIgOGMxLjggMCAzLjUuNiA0LjggMS42bDMuNi0zLjZDMTguNCAzLjIgMTUuNCAyIDEyIDIgNy4xIDIgMy4xIDUuMSAxLjMgOS4zTDQuNiAxMmMuOS0yLjcgMy41LTQuNSA2LjQtNC41eiIgZmlsbD0iI0VBNDMzNSIvPjxwYXRoIGQ9Ik05IDIwYzMgMCA1LjUtMSA3LjMtMi43bC0zLjEtMi40Yy0uOS0uNi0yLS45LTMuMi0uOS0yLjkgMC01LjUtMS44LTYuNC00LjVMMS4zIDEzLjdDMy4xIDE3LjkgNy4xIDIxIDEyIDIxeiIgZmlsbD0iIzM0QTg1MyIvPjxwYXRoIGQ9Ik05IDIwYzMgMCA1LjUtMSA3LjMtMi43bC0zLjEtMi40Yy0uOS0uNi0yLS45LTMuMi0uOS0yLjkgMC01LjUtMS44LTYuNC00LjVMMS4zIDEzLjdDMy4xIDE3LjkgNy4xIDIxIDEyIDIxeiIgZmlsbD0iI0ZCQkMwNSIvPjwvZz48L3N2Zz4=" alt="Google" style="height: 20px;">
                        <h3>Choose an account</h3>
                        <button class="google-picker-close" onclick="closeGooglePicker()">&times;</button>
                    </div>
                    <div class="google-picker-accounts">
                        <div class="google-account" onclick="selectGoogleAccount('farmer1@gmail.com', 'Juan Dela Cruz')">
                            <div class="account-avatar">JD</div>
                            <div class="account-info">
                                <div class="account-name">Juan Dela Cruz</div>
                                <div class="account-email">farmer1@gmail.com</div>
                            </div>
                        </div>
                        <div class="google-account" onclick="selectGoogleAccount('maria.santos@gmail.com', 'Maria Santos')">
                            <div class="account-avatar">MS</div>
                            <div class="account-info">
                                <div class="account-name">Maria Santos</div>
                                <div class="account-email">maria.santos@gmail.com</div>
                            </div>
                        </div>
                        <div class="google-account" onclick="selectGoogleAccount('pedro.farmer@gmail.com', 'Pedro Farmer')">
                            <div class="account-avatar">PF</div>
                            <div class="account-info">
                                <div class="account-name">Pedro Farmer</div>
                                <div class="account-email">pedro.farmer@gmail.com</div>
                            </div>
                        </div>
                        <div class="google-account add-account" onclick="selectGoogleAccount('new.farmer@gmail.com', 'New Farmer')">
                            <div class="account-avatar">+</div>
                            <div class="account-info">
                                <div class="account-name">Use another account</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Add styles for the modal
            const style = document.createElement('style');
            style.textContent = `
                .google-picker-modal {
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    z-index: 10000;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }
                
                .google-picker-overlay {
                    position: absolute;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.5);
                }
                
                .google-picker-content {
                    background: white;
                    border-radius: 8px;
                    width: 400px;
                    max-width: 90vw;
                    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
                    position: relative;
                    z-index: 1;
                }
                
                .google-picker-header {
                    padding: 20px;
                    border-bottom: 1px solid #e0e0e0;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                }
                
                .google-picker-header h3 {
                    margin: 0;
                    color: #202124;
                    font-size: 16px;
                    flex: 1;
                }
                
                .google-picker-close {
                    background: none;
                    border: none;
                    font-size: 24px;
                    color: #5f6368;
                    cursor: pointer;
                    padding: 0;
                    width: 24px;
                    height: 24px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }
                
                .google-picker-accounts {
                    padding: 0;
                }
                
                .google-account {
                    display: flex;
                    align-items: center;
                    padding: 12px 20px;
                    cursor: pointer;
                    transition: background-color 0.2s;
                }
                
                .google-account:hover {
                    background-color: #f8f9fa;
                }
                
                .account-avatar {
                    width: 40px;
                    height: 40px;
                    border-radius: 50%;
                    background: #1a73e8;
                    color: white;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-weight: 500;
                    margin-right: 12px;
                }
                
                .add-account .account-avatar {
                    background: #f8f9fa;
                    color: #5f6368;
                    border: 2px solid #dadce0;
                    font-size: 20px;
                }
                
                .account-info {
                    flex: 1;
                }
                
                .account-name {
                    font-size: 14px;
                    color: #202124;
                    font-weight: 400;
                }
                
                .account-email {
                    font-size: 12px;
                    color: #5f6368;
                    margin-top: 2px;
                }
            `;
            document.head.appendChild(style);
        }
        
        // Close Google Account Picker
        function closeGooglePicker() {
            const modal = document.querySelector('.google-picker-modal');
            if (modal) {
                modal.remove();
            }
        }
        
        // Select Google Account
        function selectGoogleAccount(email, name) {
            closeGooglePicker();
            showGoogleLoading();
            
            // Simulate authentication delay
            setTimeout(() => {
                const demoToken = createDemoGoogleToken(email, name);
                handleCredentialResponse({ credential: demoToken });
            }, 1500);
        }
        
        // Create demo Google token for testing
        function createDemoGoogleToken(email = 'demo.farmer@gmail.com', name = 'Demo Google Farmer') {
            const header = btoa(JSON.stringify({ alg: "RS256", typ: "JWT" }));
            const payload = btoa(JSON.stringify({
                iss: "accounts.google.com",
                sub: "demo_google_user_" + Date.now(),
                email: email,
                name: name,
                picture: null,
                email_verified: true,
                exp: Math.floor(Date.now() / 1000) + 3600
            }));
            const signature = btoa("demo_signature");
            
            return `${header}.${payload}.${signature}`;
        }
        
        // Show loading state for Google sign-in
        function showGoogleLoading() {
            const googleBtn = document.querySelector('.g_id_signin');
            const customBtn = document.getElementById('customGoogleBtn');
            
            if (googleBtn) {
                googleBtn.style.opacity = '0.6';
                googleBtn.style.pointerEvents = 'none';
            }
            
            if (customBtn) {
                customBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Signing in with Google...';
                customBtn.disabled = true;
            }
            
            // Show loading message
            const loadingMsg = document.createElement('div');
            loadingMsg.id = 'googleLoadingMsg';
            loadingMsg.className = 'text-center mt-2';
            loadingMsg.style.color = 'rgba(255, 255, 255, 0.9)';
            loadingMsg.style.fontSize = '0.9rem';
            loadingMsg.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Authenticating with Google...';
            
            const divider = document.querySelector('.divider');
            divider.parentNode.insertBefore(loadingMsg, divider.nextSibling);
        }
        
        // Hide loading state
        function hideGoogleLoading() {
            const googleBtn = document.querySelector('.g_id_signin');
            const customBtn = document.getElementById('customGoogleBtn');
            const loadingMsg = document.getElementById('googleLoadingMsg');
            
            if (googleBtn) {
                googleBtn.style.opacity = '1';
                googleBtn.style.pointerEvents = 'auto';
            }
            
            if (customBtn) {
                customBtn.innerHTML = '<i class="fab fa-google"></i> Continue with Google';
                customBtn.disabled = false;
            }
            
            if (loadingMsg) {
                loadingMsg.remove();
            }
        }
        
        // Show success message
        function showSuccessMessage(message) {
            const successMsg = document.createElement('div');
            successMsg.className = 'alert';
            successMsg.style.background = 'rgba(16, 185, 129, 0.2)';
            successMsg.style.borderColor = 'rgba(16, 185, 129, 0.3)';
            successMsg.innerHTML = '<i class="fas fa-check-circle me-2"></i>' + message;
            
            const loginCard = document.querySelector('.login-card');
            loginCard.insertBefore(successMsg, loginCard.firstChild);
            
            // Remove after 3 seconds
            setTimeout(() => {
                if (successMsg.parentNode) {
                    successMsg.remove();
                }
            }, 3000);
        }
        
        // Show error message
        function showErrorMessage(message) {
            const errorMsg = document.createElement('div');
            errorMsg.className = 'alert';
            errorMsg.style.background = 'rgba(220, 53, 69, 0.2)';
            errorMsg.style.borderColor = 'rgba(220, 53, 69, 0.3)';
            errorMsg.innerHTML = '<i class="fas fa-exclamation-triangle me-2"></i>' + message;
            
            const loginCard = document.querySelector('.login-card');
            loginCard.insertBefore(errorMsg, loginCard.firstChild);
            
            // Remove after 5 seconds
            setTimeout(() => {
                if (errorMsg.parentNode) {
                    errorMsg.remove();
                }
            }, 5000);
        }
        
        // Auto-focus email input and handle registered users
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user just registered
            const registeredEmail = '{{registeredEmail}}';
            const registeredRole = '{{registeredRole}}';
            
            if (registeredEmail && registeredEmail !== '{{registeredEmail}}') {
                // User just registered, pre-fill their email and select their role
                document.getElementById('email').value = registeredEmail;
                document.getElementById('password').value = '';
                
                // Select the appropriate role tab
                if (registeredRole && registeredRole !== '{{registeredRole}}') {
                    const roleTab = document.querySelector(`[data-role="${registeredRole}"]`);
                    if (roleTab) {
                        // Remove active class from all tabs
                        document.querySelectorAll('.role-tab').forEach(t => t.classList.remove('active'));
                        // Add active class to registered role tab
                        roleTab.classList.add('active');
                        // Update hidden input
                        document.getElementById('selectedRole').value = registeredRole;
                    }
                }
                
                // Focus on password field since email is pre-filled
                document.getElementById('password').focus();
                
                // Show helpful message
                setTimeout(() => {
                    const helpMsg = document.createElement('div');
                    helpMsg.className = 'text-center mt-2';
                    helpMsg.style.color = 'rgba(255, 255, 255, 0.9)';
                    helpMsg.style.fontSize = '0.85rem';
                    helpMsg.innerHTML = '<i class="fas fa-info-circle me-1"></i>Please enter your password to complete login';
                    
                    const passwordGroup = document.querySelector('.form-group:has(#password)');
                    passwordGroup.appendChild(helpMsg);
                    
                    // Remove message after 5 seconds
                    setTimeout(() => {
                        if (helpMsg.parentNode) {
                            helpMsg.remove();
                        }
                    }, 5000);
                }, 1000);
                
            } else {
                // No pre-filled credentials for security
                document.getElementById('email').value = '';
                document.getElementById('password').value = '';
                document.getElementById('email').focus();
            }
        });
    </script>
</body>
</html>